#!/usr/bin/env python3
"""Quick runner script for ytmusic-manager with virtual environment activation."""

import os
import sys
import subprocess
from pathlib import Path


def main():
    """Run ytmusic-manager with activated virtual environment."""
    # Get the directory where this script is located
    script_dir = Path(__file__).parent.absolute()
    
    # Check for virtual environment
    venv_path = script_dir / "venv"
    if not venv_path.exists():
        print("Error: Virtual environment not found at 'venv/'")
        print("Please create it with: python -m venv venv")
        sys.exit(1)
    
    # Determine the correct activation script and python executable
    if os.name == 'nt':  # Windows
        python_exe = venv_path / "Scripts" / "python.exe"
        if not python_exe.exists():
            python_exe = venv_path / "Scripts" / "python"
    else:  # Unix-like (Linux, macOS)
        python_exe = venv_path / "bin" / "python"
    
    if not python_exe.exists():
        print(f"Error: Python executable not found at {python_exe}")
        sys.exit(1)
    
    # Run ytmusic-manager with the virtual environment's Python
    cmd = [str(python_exe), "-m", "ytmusic_manager.cli"] + sys.argv[1:]
    
    try:
        subprocess.run(cmd, check=False)
    except KeyboardInterrupt:
        print("\nCancelled by user")
        sys.exit(1)
    except Exception as e:
        print(f"Error running ytmusic-manager: {e}")
        sys.exit(1)


if __name__ == "__main__":
    main()